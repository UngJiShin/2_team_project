# 📄 전처리 기준 가이드라인 (공통 규칙)

아래 기준은 데이터 전처리 작업 시 반드시 통일해야 할 규칙입니다. <br>
최종 병합과 모델 학습을 위해 **형식, 단위, 열 이름**이 정확히 일치해야 하니 꼭 참고해주세요 🙏

---

## ✅ 전처리 필수 기준 요약

| 항목       | 기준 내용 요약                                 |
| -------- | ---------------------------------------- |
| 날짜 컬럼    | `month` = datetime 형식 (`YYYY-MM-01`)     |
| 지역 컬럼    | `region` = 광역시도 단위, '특별시'/'광역시' 제거 후 정리  |
| 변수명 통일   | 아래 통일 기준에 따라 `snake_case` 변수명 사용         |
| 컬럼 순서    | **`month`, `region`, `변수명` 순서로 정렬 필수**   |
| 단위 처리    | 단위 통일 또는 주석 명시. `export_amount`는 확인 후 결정 |
| 결측치 처리   | 변수별 방식 지정 (dropna, interpolate, 평균 대체 등) |
| 예외 처리 지침 | 구조 불일치 시 팀장에게 먼저 공유, 변경 시 주석 필수          |

---

## ✅ 공통 열(Column) 명칭

| 열 이름   | 설명                     | 예시                                   |
| ------ | ---------------------- | ------------------------------------ |
| month  | 기준 월 (datetime 객체)     | 2024-05-01                           |
| region | 지역명 (광역 단위 기준)         | 서울, 경기, 부산                           |
| 변수명    | 각자 맡은 변수 이름 (아래 기준 참고) | power\_kwh, prod\_index, temp\_avg 등 |

### 🎯 변수명 통합 기준

| 의미       | 변수명               | 예시 단위      |
| -------- | ----------------- | ---------- |
| 제조업 생산지수 | `prod_index`      | 기준=100     |
| 전력 사용량   | `power_kwh`       | KWh        |
| 평균 기온    | `temp_avg`        | °C         |
| 강수량      | `precipitation`   | mm         |
| 수출액      | `export_amount`   | 억 원 / 억 달러 |
| 설비 가동률   | `util_rate`       | %          |
| 재고지수     | `inventory_index` | 무단위        |
| 출하지수     | `shipment_index`  | 무단위        |

### 📌 변수명 작성 시 추가 가이드

* 변수명은 **영문 소문자 + snake\_case** 형식으로 작성합니다.
  예: `power_kwh`, `prod_index`

* **단위를 변수명에 직접 쓰지 마세요.**
  예: `export_amount_usd` ❌ → `export_amount` ✅

* 변수명은 프로젝트 전체에서 **정책적으로 고정**됩니다.
  → 모든 팀원은 동일한 변수명을 사용해야 병합 및 모델링이 원활합니다.

---

## 📅 날짜 처리 규칙

* 모든 `month` 값은 **datetime64** 형식 (`YYYY-MM-01`)
* 일(day)은 전부 `1일`로 맞춰주세요 → 월 단위 분석 기준

```python
df['month'] = pd.to_datetime(df['month'])
```

---

## 🌍 지역명 처리

* '서울특별시', '경기도' → '서울', '경기' 형식으로 간단히 통일
* 지역 구분 없는 경우 `region = "전국"`으로 통일

```python
df['region'] = df['region'].str.replace('특별시', '').str.replace('광역시', '').str.strip()
```

---

## 📐 단위 규칙

| 변수명            | 기본 단위 예시      | 비고                |
| -------------- | ------------- | ----------------- |
| power\_kwh     | KWh           | 유지 예정             |
| prod\_index    | 기준 100 (무단위)  | 유지 예정             |
| temp\_avg      | °C            | 유지 예정             |
| precipitation  | mm            | 유지 예정             |
| export\_amount | (억 달러 or 억 원) | ⚠️ 데이터 확인 후 결정 필요 |

> ⚠️ 수출입 지표(`export_amount`)는 단위가 달러일 수 있으므로
> 실제 데이터 확보 후 원화 환산 여부 또는 단위 통일 여부를 정할 예정입니다.

---

## 📌 컬럼 순서 기준

* 전처리 후 최종 결과는 **반드시 아래 순서로 컬럼 정렬**:

```
month, region, 변수명
```

* 병합 스크립트가 해당 순서를 기준으로 동작하므로 필수입니다.

```python
df = df[['month', 'region', 'power_kwh']]  # 예시
```

---

## ❗ 결측치 처리 기준

| 변수     | 처리 방식                       | 이유              |
| ------ | --------------------------- | --------------- |
| 전력량    | 보간 (`interpolate()`)        | 시계열 유지          |
| 생산지수   | dropna()                    | 모델 대상이므로 보수적 처리 |
| 기온/강수량 | 평균 대체 (`fillna(df.mean())`) | 안정적인 예측값 생성     |

* 0으로 임의 대체 ❌
* 처리 방식은 코드에 주석으로 명시해주세요

```python
df['temp_avg'].fillna(df['temp_avg'].mean(), inplace=True)  # 평균으로 대체
```

---

## 🔄 예외 상황 처리 지침

예측 프로젝트에서는 다양한 공공데이터를 활용하다 보니,
형식이 통일되지 않거나 기준에 어긋나는 데이터가 발생할 수 있습니다.
그럴 경우 아래 지침에 따라 일관성 있게 처리해주세요.

* **구조가 기준과 다른 데이터**를 만난 경우:

  * ⚠️ 반드시 팀장에게 먼저 공유하고, 개인 판단으로 수정하지 않기
  * 구조나 단위 등을 바꿔야 하는 경우에는 **코드에 주석으로 변경 이유를 명확히 기재**할 것

* 예외적으로 컬럼명이 다르거나, 월 단위가 아닌 일 단위인 경우 등도 여기에 해당합니다.

* 가능하면 기준에 맞게 수동 정제하거나, `변환 함수`로 통일하도록 권장합니다.

예)

```python
# 원본 데이터가 일 단위라 월 기준으로 집계함
monthly_temp = raw_temp.resample('M', on='date').mean().reset_index()
monthly_temp['month'] = monthly_temp['date'].dt.to_period('M').dt.to_timestamp()
```

❗ 예외 처리는 최대한 줄이고, 기준에 맞춰 데이터를 통합하는 방향으로 조정해주세요.

* ⚠️ 먼저 팀장에게 공유한 뒤 진행

* 구조 변경 시에는 반드시 주석 추가 및 설명 남기기

* 예외 처리는 최대한 지양하고, 기준에 맞추는 방식으로 조정 권장

---

## ✅ 전처리 함수 작성 규칙

* 모든 전처리 코드는 아래 형태로 작성

```python
def preprocess_xxx() -> pd.DataFrame:
    df = pd.read_csv("...")
    # 전처리 작업
    return df[["month", "region", "변수명"]]
```

* 파일명은 `power.py`, `production.py`, `weather.py` 등으로 저장

---

## 📁 파일 저장 위치

| 폴더            | 설명                                    |
| ------------- | ------------------------------------- |
| data/raw/     | 원본 데이터                                |
| data/interim/ | 각 팀원 전처리 결과 (`power_processed.csv` 등) |
| data/final/   | 팀장이 병합한 최종 결과 (`final_dataset.csv`)   |

---

## 📌 병합 기준 (팀장 참고용)

* 병합 기준 열: `month`, `region`
* 병합 방식: inner join 또는 left join (필요 시 조정)
* 병합 파일: `combine.py` 에서 처리

---

질문은 언제든 환영이고,
이 기준에 맞춰 진행해주시면 병합과 모델링이 훨씬 수월해집니다!
화이팅! 💪
